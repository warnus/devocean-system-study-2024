# 개략적인 규모 추정
구글의 시니어에 따르면 "개략적인 규모 추정(back-of-the-envelope estimation)은 보편적으로 통용되는 성능 수치상에서 사고 실험(thought experiments)을 행하여 추정치를 계산하는 행위로서, 어떤 설계가 요구사항에 부합할 것인지 보기 위한 것.

개략적 규모 추정을 효과적으로 해 내려면 규모 확장성을 표현하는 데 필요한 기본기가 필요. 

## 2의 제곱수
분산 시스템에서 다루는 데이터 양은 엄청나게 커질 수 있으나 계산법은 기본을 크게 벗어나지 않음. 

![](https://velog.velcdn.com/images/iln1027/post/7716ba5d-078d-413c-83d3-e13299a7ad0f/image.png)

## 응답지연 값
구글의 제프 딘은 2010년 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값을 공개. 현재는 더 빠른 컴퓨터가 등장하며 더 이상 유효하지 않게 되었지만, 이 수치들은 대략적인 처리 속도를 짐작할 수 있게 해줌.

![](https://velog.velcdn.com/images/iln1027/post/6c09e97f-ff03-45c4-85ae-e94d53d8f8f1/image.png)

![](https://velog.velcdn.com/images/iln1027/post/64776647-822a-4902-9c6d-7daeede2611e/image.png)

위 수치들을 분석하면 다음과 같은 결론이 나옴.
- 메모리는 빠르지만 디스크는 아직 느리다
- 디스크 탐색(seek)은 가능한 한 피하라
- 단순한 압축 알고리즘은 빠르다
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸림

## 가용성에 관계된 수치들
고가용성(high availability)은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어.

SLA(Service Level Agreement)는 서비스 사업자(service provider)가 보편적으로 사용하는 용어로, 고객과 맺어진 합의를 의미.

![](https://velog.velcdn.com/images/iln1027/post/ea9d5c3d-b744-482d-82cb-4ebd2018ee13/image.png)

## 예제: 트위터 QPS와 저장소 요구량 추정

### 가정
- MAU는 3억명
- 50%의 사용자가 트위터를 매일 사용
- 평균적으로 각 사용자는 매일 2건의 트윗을 올림
- 미디어를 포함하는 트윗은 10% 정도
- 데이터는 5년간 보관

### 추정
QPS(Query Per Second) 추정치
- DAU = 3억 * 0.50 = 1.5억
- QPS = 1.5억 * 2 / 24 / 3600 = 약 3500
- 최대 QPS(Peek QPS) = 2 * QPS = 7000

미디어 저장을 위한 저장소 요구량
- 평균 트윗 크기
  - tweet_id에 64바이트
  - 텍스트에 140바이트
  - 미디어에 1MB
- 미디어 저장소 요구량: 1.5억 * 2 * 0.10 * 1MB = 30TB/일
- 5년간 보관하기 위한 저장소 요구량: 30TB * 365 * 5 = 55PB
